<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¡°ì‘ëœ ë™ì „ - í™•ë¥  ê²Œì„</title>
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <!-- ì—­í•  ì„ íƒ í™”ë©´ -->
        <div id="role-selection" class="screen active">
            <h1>ğŸª™ ì¡°ì‘ëœ ë™ì „</h1>
            <p class="subtitle">ë™ì „ì˜ ë¹„ë°€ì„ ì°¾ì•„ë¼!</p>
            <div class="role-buttons">
                <button class="role-btn maker-btn" onclick="selectRole('maker')">
                    ğŸ”§ ë™ì „ ì œì‘ì
                </button>
                <button class="role-btn detective-btn" onclick="selectRole('detective')">
                    ğŸ” ë™ì „ íƒì •
                </button>
            </div>
        </div>

        <!-- ì œì‘ì ì„¤ì • í™”ë©´ -->
        <div id="maker-setup" class="screen">
            <h2>ë™ì „ ì œì‘ì ì„¤ì •</h2>
            <div id="login-section" class="setup-box">
                <h3>ğŸ‘¤ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤</h3>
                <p style="color: #888; margin-bottom: 20px;">ê²Œì„ì„ ìƒì„±í•˜ë ¤ë©´ Google ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ì„¸ìš”</p>
                <button class="start-btn" onclick="signInWithGoogle()">ğŸ” Googleë¡œ ë¡œê·¸ì¸</button>
            </div>
            <div id="game-setup" class="setup-box" style="display:none;">
                <div id="user-info" style="text-align: center; margin-bottom: 20px; padding: 15px; background: #f0f0f0; border-radius: 10px;">
                    <p style="margin: 0; color: #666;">ğŸ‘¤ <span id="user-name"></span></p>
                </div>
                <label for="probability">ì•ë©´ì´ ë‚˜ì˜¬ í™•ë¥  (%)</label>
                <input type="number" id="probability" min="0" max="100" value="50">
                <div class="probability-display">
                    <span id="probability-value">50</span>%
                </div>
                
                <label for="max-attempts">ìµœëŒ€ ì‹œë„ íšŸìˆ˜</label>
                <input type="number" id="max-attempts" min="1" max="10" value="5">
                
                <button class="start-btn" onclick="createGameRoom()">ê²Œì„ ì‹œì‘</button>
            </div>
            <div id="room-code-display" class="room-code-box" style="display:none;">
                <h3>ì…ì¥ ì½”ë“œ</h3>
                <div class="code">
                    <span id="room-code"></span>
                </div>
                <p class="info">íƒì •ì—ê²Œ ì´ ì½”ë“œë¥¼ ì•Œë ¤ì£¼ì„¸ìš”!</p>
            </div>
            <button class="back-btn" onclick="backToRoleSelection()">â† ëŒì•„ê°€ê¸°</button>
        </div>

        <!-- íƒì • ì…ì¥ í™”ë©´ -->
        <div id="detective-join" class="screen">
            <h2>ë™ì „ íƒì • ì…ì¥</h2>
            <div class="setup-box">
                <label for="join-code">ì…ì¥ ì½”ë“œ ì…ë ¥</label>
                <input type="text" id="join-code" placeholder="ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”" maxlength="6">
                <button class="start-btn" onclick="joinGame()">ì…ì¥í•˜ê¸°</button>
            </div>
            <button class="back-btn" onclick="backToRoleSelection()">â† ëŒì•„ê°€ê¸°</button>
        </div>

        <!-- ê²Œì„ í™”ë©´ -->
        <div id="game-screen" class="screen">
            <div class="game-header">
                <h2>ğŸ” ë™ì „ íƒì •</h2>
                <div class="attempts-left">
                    ë‚¨ì€ ì‹œë„: <span id="attempts-left">5</span>íšŒ
                </div>
            </div>

            <div class="coin-container">
                <div id="coin" class="coin">
                    <div class="coin-face front"></div>
                    <div class="coin-face back"></div>
                </div>
            </div>

            <div class="stats">
                <div class="stat-item">
                    <div class="stat-label">ì´ ë˜ì§„ íšŸìˆ˜</div>
                    <div class="stat-value" id="total-flips">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">ì•ë©´ ë‚˜ì˜¨ íšŸìˆ˜</div>
                    <div class="stat-value" id="heads-count">0</div>
                </div>
            </div>

            <div class="controls">
                <button class="auto-flip-btn" id="auto-flip-btn" onclick="toggleAutoFlip()">
                    <span class="btn-icon">â–¶</span>
                    <span class="btn-text">ìë™ ë˜ì§€ê¸° ì‹œì‘</span>
                </button>
            </div>

            <div class="guess-section" id="guess-section">
                <h3>ğŸ¯ í™•ë¥  ì¶”ì¸¡í•˜ê¸°</h3>
                <div class="guess-input">
                    <input type="number" id="guess" min="0" max="100" placeholder="0-100">
                    <span>%</span>
                </div>
                <button class="submit-btn" onclick="submitGuess()">ì œì¶œí•˜ê¸°</button>
            </div>

            <div class="success-message hidden" id="success-message">
                <h3>ğŸ‰ ì •ë‹µì„ ë§ì¶”ì…¨ìŠµë‹ˆë‹¤!</h3>
                <p id="success-text"></p>
            </div>

            <button class="back-btn" onclick="backToRoleSelection()" style="margin-top: 20px;">â† ë‹¤ë¥¸ ê²Œì„ ì°¸ì—¬í•˜ê¸°</button>
        </div>

        <!-- ê²°ê³¼ í™”ë©´ -->
        <div id="result-screen" class="screen">
            <div id="result-content"></div>
            <button class="start-btn" onclick="resetGame()">ìƒˆ ê²Œì„ ì‹œì‘</button>
        </div>
    </div>

    <!-- ë©”ì‹œì§€ ë°•ìŠ¤ -->
    <div class="overlay" id="overlay" onclick="closeMessage()"></div>
    <div class="message-box" id="message-box">
        <div class="message-icon" id="message-icon"></div>
        <div class="message-text" id="message-text"></div>
        <button class="message-close" onclick="closeMessage()">í™•ì¸</button>
    </div>

    <script src="game.js"></script>
    <script type="module">
      import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
      import { getAuth, GoogleAuthProvider, signInWithPopup } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
      import { getFirestore, collection, addDoc, getDoc, doc, onSnapshot, getDocs, query, where, setDoc, deleteDoc } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

      // Firebase ì„¤ì • (Firebase Consoleì—ì„œ ë³µì‚¬)
      const firebaseConfig = {
        apiKey: "AIzaSyCfZLXKeLx-Q80NR1EuDWPxIe6o4QWl28U",
        authDomain: "coin-game-d8e7a.firebaseapp.com",
        projectId: "coin-game-d8e7a",
        storageBucket: "coin-game-d8e7a.firebasestorage.app",
        messagingSenderId: "1057831129270",
        appId: "1:1057831129270:web:41c5e4a26f999d0df5d617"
      };
      // Firebase ì´ˆê¸°í™”
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const db = getFirestore(app);
      
      // ì „ì—­ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •
      window.firebaseAuth = auth;
      window.firebaseDb = db;
      window.GoogleAuthProvider = GoogleAuthProvider;
      window.signInWithPopup = signInWithPopup;
      window.firestoreCollection = collection;
      window.firestoreAddDoc = addDoc;
      window.firestoreGetDoc = getDoc;
      window.firestoreDoc = doc;
      window.firestoreOnSnapshot = onSnapshot;
      window.firestoreGetDocs = getDocs;
      window.firestoreQuery = query;
      window.firestoreWhere = where;
      window.firestoreSetDoc = setDoc;
      window.firestoreDeleteDoc = deleteDoc;
    </script>
</body>
</html>
